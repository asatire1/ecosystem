<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #2a2c33; -webkit-text-stroke: #2a2c33; background-color: #ffffff}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #db3f39; -webkit-text-stroke: #db3f39; background-color: #ffffff}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #42933e; -webkit-text-stroke: #42933e; background-color: #ffffff}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #2a2c33; -webkit-text-stroke: #2a2c33; background-color: #ffffff; min-height: 16.0px}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #a75705; -webkit-text-stroke: #a75705; background-color: #ffffff}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #8f9096; -webkit-text-stroke: #8f9096; background-color: #ffffff}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #325eee; -webkit-text-stroke: #325eee; background-color: #ffffff}
    span.s1 {font-kerning: none}
    span.s2 {font-kerning: none; color: #db3f39; -webkit-text-stroke: 0px #db3f39}
    span.s3 {font-kerning: none; color: #a75705; -webkit-text-stroke: 0px #a75705}
    span.s4 {font-kerning: none; color: #42933e; -webkit-text-stroke: 0px #42933e}
    span.s5 {font-kerning: none; color: #2a2c33; -webkit-text-stroke: 0px #2a2c33}
    span.s6 {font-kerning: none; color: #930093; -webkit-text-stroke: 0px #930093}
    span.s7 {font-kerning: none; color: #325eee; -webkit-text-stroke: 0px #325eee}
    span.s8 {font-kerning: none; color: #8f9096; -webkit-text-stroke: 0px #8f9096}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;</span><span class="s2">html </span><span class="s3">lang</span><span class="s1">="</span><span class="s4">en</span><span class="s1">"&gt;</span></p>
<p class="p2"><span class="s5">&lt;</span><span class="s1">head</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">meta </span><span class="s3">charset</span><span class="s1">="</span><span class="s4">UTF-8</span><span class="s1">"&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">meta </span><span class="s3">name</span><span class="s5">="</span><span class="s1">viewport</span><span class="s5">"</span><span class="s2"> </span><span class="s3">content</span><span class="s5">="</span><span class="s1">width=device-width, initial-scale=1.0</span><span class="s5">"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">title</span><span class="s1">&gt;Ecosystem Simulation Game&lt;/</span><span class="s2">title</span><span class="s1">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">script </span><span class="s3">crossorigin</span><span class="s2"> </span><span class="s3">src</span><span class="s5">="</span><span class="s1">https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js</span><span class="s5">"&gt;&lt;/</span><span class="s2">script</span><span class="s5">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">script </span><span class="s3">crossorigin</span><span class="s2"> </span><span class="s3">src</span><span class="s5">="</span><span class="s1">https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js</span><span class="s5">"&gt;&lt;/</span><span class="s2">script</span><span class="s5">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">script </span><span class="s3">src</span><span class="s5">="</span><span class="s1">https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js</span><span class="s5">"&gt;&lt;/</span><span class="s2">script</span><span class="s5">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">script </span><span class="s3">src</span><span class="s5">="</span><span class="s1">https://cdn.tailwindcss.com</span><span class="s5">"&gt;&lt;/</span><span class="s2">script</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">style</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s4">body</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">margin</span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">padding</span><span class="s1">: </span><span class="s3">0</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">overflow</span><span class="s1">: hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s4">#root</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">width</span><span class="s1">: </span><span class="s3">100</span><span class="s1">vw;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">height</span><span class="s1">: </span><span class="s3">100</span><span class="s1">vh;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/</span><span class="s2">style</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s5">&lt;/</span><span class="s1">head</span><span class="s5">&gt;</span></p>
<p class="p2"><span class="s5">&lt;</span><span class="s1">body</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">div </span><span class="s3">id</span><span class="s1">="</span><span class="s4">root</span><span class="s1">"&gt;&lt;/</span><span class="s2">div</span><span class="s1">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">script </span><span class="s3">type</span><span class="s5">="</span><span class="s1">text/babel</span><span class="s5">"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> { useState, useEffect, useRef } </span><span class="s7">=</span><span class="s1"> React;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> </span><span class="s3">20</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> </span><span class="s3">18</span><span class="s1">;</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s5"> </span><span class="s1">GAME_DAY_DURATION</span><span class="s5"> </span><span class="s7">=</span><span class="s5"> </span><span class="s1">30</span><span class="s5">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s3">WIN_DAYS</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> </span><span class="s3">10</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">GRASS</span><span class="s7">:</span><span class="s1"> </span><span class="s4">'grass'</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">RABBIT</span><span class="s7">:</span><span class="s1"> </span><span class="s4">'rabbit'</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">FOX</span><span class="s7">:</span><span class="s1"> </span><span class="s4">'fox'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s3">TIMERS</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">grass</span><span class="s7">:</span><span class="s1"> { </span><span class="s2">spread</span><span class="s7">:</span><span class="s1"> </span><span class="s3">5</span><span class="s1">, </span><span class="s2">regrow</span><span class="s7">:</span><span class="s1"> </span><span class="s3">15</span><span class="s1"> },</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1">rabbit</span><span class="s7">:</span><span class="s5"> { </span><span class="s1">hunger</span><span class="s7">:</span><span class="s5"> </span><span class="s3">12</span><span class="s5">, </span><span class="s1">reproduction</span><span class="s7">:</span><span class="s5"> </span><span class="s3">40</span><span class="s5">, </span><span class="s1">detectionRange</span><span class="s7">:</span><span class="s5"> </span><span class="s3">3</span><span class="s5">, </span><span class="s1">speed</span><span class="s7">:</span><span class="s5"> </span><span class="s3">2</span><span class="s5"> },</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1">fox</span><span class="s7">:</span><span class="s5"> { </span><span class="s1">hunger</span><span class="s7">:</span><span class="s5"> </span><span class="s3">25</span><span class="s5">, </span><span class="s1">reproduction</span><span class="s7">:</span><span class="s5"> </span><span class="s3">90</span><span class="s5">, </span><span class="s1">detectionRange</span><span class="s7">:</span><span class="s5"> </span><span class="s3">5</span><span class="s5">, </span><span class="s1">speed</span><span class="s7">:</span><span class="s5"> </span><span class="s3">4</span><span class="s5"> }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">        </span></span><span class="s1">// Lucide icons as SVG components</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">Pause</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;</span><span class="s1">svg width</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> height</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> viewBox</span><span class="s7">=</span><span class="s4">"0 0 24 24"</span><span class="s1"> fill</span><span class="s7">=</span><span class="s4">"none"</span><span class="s1"> stroke</span><span class="s7">=</span><span class="s4">"currentColor"</span><span class="s1"> strokeWidth</span><span class="s7">=</span><span class="s4">"2"</span><span class="s1"> strokeLinecap</span><span class="s7">=</span><span class="s4">"round"</span><span class="s1"> strokeLinejoin</span><span class="s7">=</span><span class="s4">"round"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">rect x</span><span class="s7">=</span><span class="s4">"6"</span><span class="s1"> y</span><span class="s7">=</span><span class="s4">"4"</span><span class="s1"> width</span><span class="s7">=</span><span class="s4">"4"</span><span class="s1"> height</span><span class="s7">=</span><span class="s4">"16"</span><span class="s7">&gt;&lt;/</span><span class="s1">rect</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">rect x</span><span class="s7">=</span><span class="s4">"14"</span><span class="s1"> y</span><span class="s7">=</span><span class="s4">"4"</span><span class="s1"> width</span><span class="s7">=</span><span class="s4">"4"</span><span class="s1"> height</span><span class="s7">=</span><span class="s4">"16"</span><span class="s7">&gt;&lt;/</span><span class="s1">rect</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;/</span><span class="s1">svg</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">Play</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;</span><span class="s1">svg width</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> height</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> viewBox</span><span class="s7">=</span><span class="s4">"0 0 24 24"</span><span class="s1"> fill</span><span class="s7">=</span><span class="s4">"none"</span><span class="s1"> stroke</span><span class="s7">=</span><span class="s4">"currentColor"</span><span class="s1"> strokeWidth</span><span class="s7">=</span><span class="s4">"2"</span><span class="s1"> strokeLinecap</span><span class="s7">=</span><span class="s4">"round"</span><span class="s1"> strokeLinejoin</span><span class="s7">=</span><span class="s4">"round"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">polygon points</span><span class="s7">=</span><span class="s4">"5 3 19 12 5 21 5 3"</span><span class="s7">&gt;&lt;/</span><span class="s1">polygon</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;/</span><span class="s1">svg</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">RotateCcw</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;</span><span class="s1">svg width</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> height</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> viewBox</span><span class="s7">=</span><span class="s4">"0 0 24 24"</span><span class="s1"> fill</span><span class="s7">=</span><span class="s4">"none"</span><span class="s1"> stroke</span><span class="s7">=</span><span class="s4">"currentColor"</span><span class="s1"> strokeWidth</span><span class="s7">=</span><span class="s4">"2"</span><span class="s1"> strokeLinecap</span><span class="s7">=</span><span class="s4">"round"</span><span class="s1"> strokeLinejoin</span><span class="s7">=</span><span class="s4">"round"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">polyline points</span><span class="s7">=</span><span class="s4">"1 4 1 10 7 10"</span><span class="s7">&gt;&lt;/</span><span class="s1">polyline</span><span class="s7">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s5">path d</span><span class="s7">=</span><span class="s1">"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"</span><span class="s7">&gt;&lt;/</span><span class="s5">path</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;/</span><span class="s1">svg</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">Info</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;</span><span class="s1">svg width</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> height</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> viewBox</span><span class="s7">=</span><span class="s4">"0 0 24 24"</span><span class="s1"> fill</span><span class="s7">=</span><span class="s4">"none"</span><span class="s1"> stroke</span><span class="s7">=</span><span class="s4">"currentColor"</span><span class="s1"> strokeWidth</span><span class="s7">=</span><span class="s4">"2"</span><span class="s1"> strokeLinecap</span><span class="s7">=</span><span class="s4">"round"</span><span class="s1"> strokeLinejoin</span><span class="s7">=</span><span class="s4">"round"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">circle cx</span><span class="s7">=</span><span class="s4">"12"</span><span class="s1"> cy</span><span class="s7">=</span><span class="s4">"12"</span><span class="s1"> r</span><span class="s7">=</span><span class="s4">"10"</span><span class="s7">&gt;&lt;/</span><span class="s1">circle</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">line x1</span><span class="s7">=</span><span class="s4">"12"</span><span class="s1"> y1</span><span class="s7">=</span><span class="s4">"16"</span><span class="s1"> x2</span><span class="s7">=</span><span class="s4">"12"</span><span class="s1"> y2</span><span class="s7">=</span><span class="s4">"12"</span><span class="s7">&gt;&lt;/</span><span class="s1">line</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">line x1</span><span class="s7">=</span><span class="s4">"12"</span><span class="s1"> y1</span><span class="s7">=</span><span class="s4">"8"</span><span class="s1"> x2</span><span class="s7">=</span><span class="s4">"12.01"</span><span class="s1"> y2</span><span class="s7">=</span><span class="s4">"8"</span><span class="s7">&gt;&lt;/</span><span class="s1">line</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;/</span><span class="s1">svg</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">BarChart3</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;</span><span class="s1">svg width</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> height</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> viewBox</span><span class="s7">=</span><span class="s4">"0 0 24 24"</span><span class="s1"> fill</span><span class="s7">=</span><span class="s4">"none"</span><span class="s1"> stroke</span><span class="s7">=</span><span class="s4">"currentColor"</span><span class="s1"> strokeWidth</span><span class="s7">=</span><span class="s4">"2"</span><span class="s1"> strokeLinecap</span><span class="s7">=</span><span class="s4">"round"</span><span class="s1"> strokeLinejoin</span><span class="s7">=</span><span class="s4">"round"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">path d</span><span class="s7">=</span><span class="s4">"M3 3v18h18"</span><span class="s7">&gt;&lt;/</span><span class="s1">path</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">path d</span><span class="s7">=</span><span class="s4">"M18 17V9"</span><span class="s7">&gt;&lt;/</span><span class="s1">path</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">path d</span><span class="s7">=</span><span class="s4">"M13 17V5"</span><span class="s7">&gt;&lt;/</span><span class="s1">path</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">path d</span><span class="s7">=</span><span class="s4">"M8 17v-3"</span><span class="s7">&gt;&lt;/</span><span class="s1">path</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;/</span><span class="s1">svg</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">MapPin</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;</span><span class="s1">svg width</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> height</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> viewBox</span><span class="s7">=</span><span class="s4">"0 0 24 24"</span><span class="s1"> fill</span><span class="s7">=</span><span class="s4">"none"</span><span class="s1"> stroke</span><span class="s7">=</span><span class="s4">"currentColor"</span><span class="s1"> strokeWidth</span><span class="s7">=</span><span class="s4">"2"</span><span class="s1"> strokeLinecap</span><span class="s7">=</span><span class="s4">"round"</span><span class="s1"> strokeLinejoin</span><span class="s7">=</span><span class="s4">"round"</span><span class="s7">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s5">path d</span><span class="s7">=</span><span class="s1">"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"</span><span class="s7">&gt;&lt;/</span><span class="s5">path</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">circle cx</span><span class="s7">=</span><span class="s4">"12"</span><span class="s1"> cy</span><span class="s7">=</span><span class="s4">"10"</span><span class="s1"> r</span><span class="s7">=</span><span class="s4">"3"</span><span class="s7">&gt;&lt;/</span><span class="s1">circle</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;/</span><span class="s1">svg</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">X</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;</span><span class="s1">svg width</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> height</span><span class="s7">=</span><span class="s4">"24"</span><span class="s1"> viewBox</span><span class="s7">=</span><span class="s4">"0 0 24 24"</span><span class="s1"> fill</span><span class="s7">=</span><span class="s4">"none"</span><span class="s1"> stroke</span><span class="s7">=</span><span class="s4">"currentColor"</span><span class="s1"> strokeWidth</span><span class="s7">=</span><span class="s4">"2"</span><span class="s1"> strokeLinecap</span><span class="s7">=</span><span class="s4">"round"</span><span class="s1"> strokeLinejoin</span><span class="s7">=</span><span class="s4">"round"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">line x1</span><span class="s7">=</span><span class="s4">"18"</span><span class="s1"> y1</span><span class="s7">=</span><span class="s4">"6"</span><span class="s1"> x2</span><span class="s7">=</span><span class="s4">"6"</span><span class="s1"> y2</span><span class="s7">=</span><span class="s4">"18"</span><span class="s7">&gt;&lt;/</span><span class="s1">line</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s1">line x1</span><span class="s7">=</span><span class="s4">"6"</span><span class="s1"> y1</span><span class="s7">=</span><span class="s4">"6"</span><span class="s1"> x2</span><span class="s7">=</span><span class="s4">"18"</span><span class="s1"> y2</span><span class="s7">=</span><span class="s4">"18"</span><span class="s7">&gt;&lt;/</span><span class="s1">line</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">&lt;/</span><span class="s1">svg</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">EcosystemGame</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [phase, setPhase] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s4">'setup'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [selectedTool, setSelectedTool] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">GRASS</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [organisms, setOrganisms] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [gameTime, setGameTime] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s3">0</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [speed, setSpeed] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s3">1</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [isPaused, setIsPaused] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [gameStatus, setGameStatus] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s6">null</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [isPlacing, setIsPlacing] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [trialMode, setTrialMode] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [showGraphs, setShowGraphs] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [showHeatMap, setShowHeatMap] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [showTutorial, setShowTutorial] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [populationHistory, setPopulationHistory] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> [deathCause, setDeathCause] </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useState</span><span class="s1">(</span><span class="s4">''</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> canvasRef </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useRef</span><span class="s1">(</span><span class="s6">null</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> animationRef </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useRef</span><span class="s1">(</span><span class="s6">null</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> lastUpdateRef </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useRef</span><span class="s1">(</span><span class="s3">Date</span><span class="s1">.</span><span class="s7">now</span><span class="s1">());</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> gameTimeRef </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useRef</span><span class="s1">(</span><span class="s3">0</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> organismsRef </span><span class="s7">=</span><span class="s1"> </span><span class="s7">useRef</span><span class="s1">([]);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">useEffect</span><span class="s1">(() </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organismsRef.current </span><span class="s7">=</span><span class="s1"> organisms;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, [organisms]);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">getCounts</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> counts </span><span class="s7">=</span><span class="s1"> { </span><span class="s2">grass</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">, </span><span class="s2">rabbit</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">, </span><span class="s2">fox</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organisms.</span><span class="s7">forEach</span><span class="s1">(org </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (org.alive) counts[org.type]</span><span class="s7">++</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">return</span><span class="s1"> counts;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> counts </span><span class="s7">=</span><span class="s1"> </span><span class="s7">getCounts</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s5"> </span><span class="s1">generateId</span><span class="s5"> </span><span class="s1">=</span><span class="s5"> () </span><span class="s1">=&gt;</span><span class="s5"> </span><span class="s4">'_'</span><span class="s5"> </span><span class="s1">+</span><span class="s5"> </span><span class="s3">Math</span><span class="s5">.</span><span class="s1">random</span><span class="s5">().</span><span class="s1">toString</span><span class="s5">(</span><span class="s3">36</span><span class="s5">).</span><span class="s1">substr</span><span class="s5">(</span><span class="s3">2</span><span class="s5">, </span><span class="s3">9</span><span class="s5">);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">gridToCanvas</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (x, y) </span><span class="s7">=&gt;</span><span class="s1"> ({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s2">x</span><span class="s7">:</span><span class="s1"> x </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">/</span><span class="s1"> </span><span class="s3">2</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s2">y</span><span class="s7">:</span><span class="s1"> y </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">/</span><span class="s1"> </span><span class="s3">2</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">canvasToGrid</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (x, y) </span><span class="s7">=&gt;</span><span class="s1"> ({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s2">x</span><span class="s7">:</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">floor</span><span class="s1">(x </span><span class="s7">/</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s2">y</span><span class="s7">:</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">floor</span><span class="s1">(y </span><span class="s7">/</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">distance</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (x1, y1, x2, y2) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">return</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">sqrt</span><span class="s1">((x2 </span><span class="s7">-</span><span class="s1"> x1) </span><span class="s7">**</span><span class="s1"> </span><span class="s3">2</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> (y2 </span><span class="s7">-</span><span class="s1"> y1) </span><span class="s7">**</span><span class="s1"> </span><span class="s3">2</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">placeOrganism</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (gridX, gridY) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (gridX </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> gridX </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> gridY </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> gridY </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1">) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> occupied </span><span class="s7">=</span><span class="s1"> organisms.</span><span class="s7">some</span><span class="s1">(org </span><span class="s7">=&gt;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>org.alive </span><span class="s7">&amp;&amp;</span><span class="s1"> org.x </span><span class="s7">===</span><span class="s1"> gridX </span><span class="s7">&amp;&amp;</span><span class="s1"> org.y </span><span class="s7">===</span><span class="s1"> gridY</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (occupied) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> newOrganism </span><span class="s7">=</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s2">id</span><span class="s7">:</span><span class="s1"> </span><span class="s7">generateId</span><span class="s1">(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s2">type</span><span class="s7">:</span><span class="s1"> selectedTool,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s2">x</span><span class="s7">:</span><span class="s1"> gridX,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s2">y</span><span class="s7">:</span><span class="s1"> gridY,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s2">alive</span><span class="s7">:</span><span class="s1"> </span><span class="s3">true</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s2">hungerTimer</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s2">reproductionTimer</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s2">health</span><span class="s7">:</span><span class="s1"> </span><span class="s3">100</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s2">trail</span><span class="s7">:</span><span class="s1"> []</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setOrganisms</span><span class="s1">(prev </span><span class="s7">=&gt;</span><span class="s1"> [</span><span class="s7">...</span><span class="s1">prev, newOrganism]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s5"> </span><span class="s1">handleCanvasInteraction</span><span class="s5"> </span><span class="s1">=</span><span class="s5"> (e) </span><span class="s1">=&gt;</span><span class="s5"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (phase </span><span class="s7">!==</span><span class="s1"> </span><span class="s4">'setup'</span><span class="s1">) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> canvas </span><span class="s7">=</span><span class="s1"> canvasRef.current;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> rect </span><span class="s7">=</span><span class="s1"> canvas.</span><span class="s7">getBoundingClientRect</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> x </span><span class="s7">=</span><span class="s1"> (e.clientX </span><span class="s7">||</span><span class="s1"> e.touches</span><span class="s7">?.</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]</span><span class="s7">?.</span><span class="s1">clientX) </span><span class="s7">-</span><span class="s1"> rect.left;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> y </span><span class="s7">=</span><span class="s1"> (e.clientY </span><span class="s7">||</span><span class="s1"> e.touches</span><span class="s7">?.</span><span class="s1">[</span><span class="s3">0</span><span class="s1">]</span><span class="s7">?.</span><span class="s1">clientY) </span><span class="s7">-</span><span class="s1"> rect.top;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> { </span><span class="s2">x</span><span class="s7">:</span><span class="s1"> gridX, </span><span class="s2">y</span><span class="s7">:</span><span class="s1"> gridY } </span><span class="s7">=</span><span class="s1"> </span><span class="s7">canvasToGrid</span><span class="s1">(x, y);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">placeOrganism</span><span class="s1">(gridX, gridY);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">handleMouseDown</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (e) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setIsPlacing</span><span class="s1">(</span><span class="s3">true</span><span class="s1">);</span></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s1">handleCanvasInteraction</span><span class="s5">(e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">handleMouseMove</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (e) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (isPlacing) </span><span class="s7">handleCanvasInteraction</span><span class="s1">(e);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">handleMouseUp</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setIsPlacing</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">startSimulation</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (counts.grass </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> counts.rabbit </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> counts.fox </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1">) {</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                    </span></span><span class="s7">alert</span><span class="s5">(</span><span class="s1">'Please place at least one of each organism type!'</span><span class="s5">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setPhase</span><span class="s1">(</span><span class="s4">'playing'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setGameTime</span><span class="s1">(</span><span class="s3">0</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>gameTimeRef.current </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>lastUpdateRef.current </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Date</span><span class="s1">.</span><span class="s7">now</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setPopulationHistory</span><span class="s1">([{ </span><span class="s2">time</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">, </span><span class="s7">...</span><span class="s1">counts }]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setDeathCause</span><span class="s1">(</span><span class="s4">''</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">clearField</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setOrganisms</span><span class="s1">([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">resetGame</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setPhase</span><span class="s1">(</span><span class="s4">'setup'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setGameTime</span><span class="s1">(</span><span class="s3">0</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setIsPaused</span><span class="s1">(</span><span class="s3">false</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setGameStatus</span><span class="s1">(</span><span class="s6">null</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>gameTimeRef.current </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setPopulationHistory</span><span class="s1">([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setDeathCause</span><span class="s1">(</span><span class="s4">''</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">clearField</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">findNearest</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (organism, targetType, maxRange) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">let</span><span class="s1"> nearest </span><span class="s7">=</span><span class="s1"> </span><span class="s6">null</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">let</span><span class="s1"> minDist </span><span class="s7">=</span><span class="s1"> maxRange;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organismsRef.current.</span><span class="s7">forEach</span><span class="s1">(target </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">target.alive </span><span class="s7">||</span><span class="s1"> target.type </span><span class="s7">!==</span><span class="s1"> targetType) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> dist </span><span class="s7">=</span><span class="s1"> </span><span class="s7">distance</span><span class="s1">(organism.x, organism.y, target.x, target.y);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (dist </span><span class="s7">&lt;</span><span class="s1"> minDist) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>minDist </span><span class="s7">=</span><span class="s1"> dist;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>nearest </span><span class="s7">=</span><span class="s1"> target;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">return</span><span class="s1"> nearest;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">moveToward</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (organism, targetX, targetY, speed, deltaTime) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> dx </span><span class="s7">=</span><span class="s1"> targetX </span><span class="s7">-</span><span class="s1"> organism.x;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> dy </span><span class="s7">=</span><span class="s1"> targetY </span><span class="s7">-</span><span class="s1"> organism.y;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> dist </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">sqrt</span><span class="s1">(dx </span><span class="s7">*</span><span class="s1"> dx </span><span class="s7">+</span><span class="s1"> dy </span><span class="s7">*</span><span class="s1"> dy);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (dist </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1">) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> moveAmount </span><span class="s7">=</span><span class="s1"> speed </span><span class="s7">*</span><span class="s1"> deltaTime;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (moveAmount </span><span class="s7">&gt;=</span><span class="s1"> dist) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>organism.x </span><span class="s7">=</span><span class="s1"> targetX;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>organism.y </span><span class="s7">=</span><span class="s1"> targetY;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s6">else</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>organism.x </span><span class="s7">+=</span><span class="s1"> (dx </span><span class="s7">/</span><span class="s1"> dist) </span><span class="s7">*</span><span class="s1"> moveAmount;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>organism.y </span><span class="s7">+=</span><span class="s1"> (dy </span><span class="s7">/</span><span class="s1"> dist) </span><span class="s7">*</span><span class="s1"> moveAmount;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">organism.trail) organism.trail </span><span class="s7">=</span><span class="s1"> [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organism.trail.</span><span class="s7">push</span><span class="s1">({ </span><span class="s2">x</span><span class="s7">:</span><span class="s1"> organism.x, </span><span class="s2">y</span><span class="s7">:</span><span class="s1"> organism.y, </span><span class="s2">time</span><span class="s7">:</span><span class="s1"> </span><span class="s3">Date</span><span class="s1">.</span><span class="s7">now</span><span class="s1">() });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (organism.trail.length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">20</span><span class="s1">) organism.trail.</span><span class="s7">shift</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">moveRandom</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (organism, speed, deltaTime) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> angle </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">random</span><span class="s1">() </span><span class="s7">*</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s3">PI</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">2</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> moveAmount </span><span class="s7">=</span><span class="s1"> speed </span><span class="s7">*</span><span class="s1"> deltaTime;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organism.x </span><span class="s7">+=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">cos</span><span class="s1">(angle) </span><span class="s7">*</span><span class="s1"> moveAmount;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organism.y </span><span class="s7">+=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">sin</span><span class="s1">(angle) </span><span class="s7">*</span><span class="s1"> moveAmount;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organism.x </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">min</span><span class="s1">(</span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">-</span><span class="s1"> </span><span class="s3">1</span><span class="s1">, organism.x));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organism.y </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">max</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">min</span><span class="s1">(</span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">-</span><span class="s1"> </span><span class="s3">1</span><span class="s1">, organism.y));</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">organism.trail) organism.trail </span><span class="s7">=</span><span class="s1"> [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organism.trail.</span><span class="s7">push</span><span class="s1">({ </span><span class="s2">x</span><span class="s7">:</span><span class="s1"> organism.x, </span><span class="s2">y</span><span class="s7">:</span><span class="s1"> organism.y, </span><span class="s2">time</span><span class="s7">:</span><span class="s1"> </span><span class="s3">Date</span><span class="s1">.</span><span class="s7">now</span><span class="s1">() });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (organism.trail.length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">20</span><span class="s1">) organism.trail.</span><span class="s7">shift</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">updateSimulation</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (deltaTime) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> newOrganisms </span><span class="s7">=</span><span class="s1"> [</span><span class="s7">...</span><span class="s1">organismsRef.current];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> toRemove </span><span class="s7">=</span><span class="s1"> [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> toAdd </span><span class="s7">=</span><span class="s1"> [];</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>newOrganisms.</span><span class="s7">forEach</span><span class="s1">(org </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">org.alive) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (org.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">GRASS</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">// Grass is stationary</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} </span><span class="s6">else</span><span class="s1"> </span><span class="s6">if</span><span class="s1"> (org.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">RABBIT</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>org.hungerTimer </span><span class="s7">+=</span><span class="s1"> deltaTime;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>org.reproductionTimer </span><span class="s7">+=</span><span class="s1"> deltaTime;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">if</span><span class="s1"> (org.hungerTimer </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">TIMERS</span><span class="s1">.rabbit.hunger) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>org.alive </span><span class="s7">=</span><span class="s1"> </span><span class="s3">false</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>toRemove.</span><span class="s7">push</span><span class="s1">(org.id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">const</span><span class="s1"> currentCounts </span><span class="s7">=</span><span class="s1"> </span><span class="s7">getCounts</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">if</span><span class="s1"> (currentCounts.rabbit </span><span class="s7">&lt;=</span><span class="s1"> </span><span class="s3">1</span><span class="s1">) </span><span class="s7">setDeathCause</span><span class="s1">(</span><span class="s4">'Rabbits went extinct from starvation'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">const</span><span class="s1"> nearestGrass </span><span class="s7">=</span><span class="s1"> </span><span class="s7">findNearest</span><span class="s1">(org, </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">GRASS</span><span class="s1">, </span><span class="s3">TIMERS</span><span class="s1">.rabbit.detectionRange);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">if</span><span class="s1"> (nearestGrass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">moveToward</span><span class="s1">(org, nearestGrass.x, nearestGrass.y, </span><span class="s3">TIMERS</span><span class="s1">.rabbit.speed, deltaTime);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">distance</span><span class="s1">(org.x, org.y, nearestGrass.x, nearestGrass.y) </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">0.5</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>org.hungerTimer </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>nearestGrass.alive </span><span class="s7">=</span><span class="s1"> </span><span class="s3">false</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>toRemove.</span><span class="s7">push</span><span class="s1">(nearestGrass.id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>} </span><span class="s6">else</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">moveRandom</span><span class="s1">(org, </span><span class="s3">TIMERS</span><span class="s1">.rabbit.speed, deltaTime);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">if</span><span class="s1"> (org.hungerTimer </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">6</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> org.reproductionTimer </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">TIMERS</span><span class="s1">.rabbit.reproduction) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">const</span><span class="s1"> nearbyRabbits </span><span class="s7">=</span><span class="s1"> organismsRef.current.</span><span class="s7">filter</span><span class="s1">(o </span><span class="s7">=&gt;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>o.alive </span><span class="s7">&amp;&amp;</span><span class="s1"> o.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">RABBIT</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">distance</span><span class="s1">(org.x, org.y, o.x, o.y) </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">5</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>).length;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">if</span><span class="s1"> (nearbyRabbits </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">8</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s6">const</span><span class="s1"> angle </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">random</span><span class="s1">() </span><span class="s7">*</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s3">PI</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">2</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>toAdd.</span><span class="s7">push</span><span class="s1">({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">id</span><span class="s7">:</span><span class="s1"> </span><span class="s7">generateId</span><span class="s1">(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">type</span><span class="s7">:</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">RABBIT</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">x</span><span class="s7">:</span><span class="s1"> org.x </span><span class="s7">+</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">cos</span><span class="s1">(angle) </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.5</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">y</span><span class="s7">:</span><span class="s1"> org.y </span><span class="s7">+</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">sin</span><span class="s1">(angle) </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.5</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">alive</span><span class="s7">:</span><span class="s1"> </span><span class="s3">true</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">hungerTimer</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">reproductionTimer</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">health</span><span class="s7">:</span><span class="s1"> </span><span class="s3">100</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">trail</span><span class="s7">:</span><span class="s1"> []</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>org.reproductionTimer </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>} </span><span class="s6">else</span><span class="s1"> </span><span class="s6">if</span><span class="s1"> (org.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">FOX</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>org.hungerTimer </span><span class="s7">+=</span><span class="s1"> deltaTime;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>org.reproductionTimer </span><span class="s7">+=</span><span class="s1"> deltaTime;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">if</span><span class="s1"> (org.hungerTimer </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">TIMERS</span><span class="s1">.fox.hunger) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>org.alive </span><span class="s7">=</span><span class="s1"> </span><span class="s3">false</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>toRemove.</span><span class="s7">push</span><span class="s1">(org.id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">const</span><span class="s1"> currentCounts </span><span class="s7">=</span><span class="s1"> </span><span class="s7">getCounts</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">if</span><span class="s1"> (currentCounts.fox </span><span class="s7">&lt;=</span><span class="s1"> </span><span class="s3">1</span><span class="s1">) </span><span class="s7">setDeathCause</span><span class="s1">(</span><span class="s4">'Foxes went extinct from starvation'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">const</span><span class="s1"> nearestRabbit </span><span class="s7">=</span><span class="s1"> </span><span class="s7">findNearest</span><span class="s1">(org, </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">RABBIT</span><span class="s1">, </span><span class="s3">TIMERS</span><span class="s1">.fox.detectionRange);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">if</span><span class="s1"> (nearestRabbit) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">moveToward</span><span class="s1">(org, nearestRabbit.x, nearestRabbit.y, </span><span class="s3">TIMERS</span><span class="s1">.fox.speed, deltaTime);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">distance</span><span class="s1">(org.x, org.y, nearestRabbit.x, nearestRabbit.y) </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">0.5</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s3">Math</span><span class="s1">.</span><span class="s7">random</span><span class="s1">() </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">0.9</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>org.hungerTimer </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>nearestRabbit.alive </span><span class="s7">=</span><span class="s1"> </span><span class="s3">false</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>toRemove.</span><span class="s7">push</span><span class="s1">(nearestRabbit.id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>} </span><span class="s6">else</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">moveRandom</span><span class="s1">(org, </span><span class="s3">TIMERS</span><span class="s1">.fox.speed, deltaTime);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">if</span><span class="s1"> (org.hungerTimer </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">10</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> org.reproductionTimer </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">TIMERS</span><span class="s1">.fox.reproduction) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">const</span><span class="s1"> nearbyRabbits </span><span class="s7">=</span><span class="s1"> organismsRef.current.</span><span class="s7">filter</span><span class="s1">(o </span><span class="s7">=&gt;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>o.alive </span><span class="s7">&amp;&amp;</span><span class="s1"> o.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">RABBIT</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">distance</span><span class="s1">(org.x, org.y, o.x, o.y) </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">8</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>).length;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">const</span><span class="s1"> nearbyFoxes </span><span class="s7">=</span><span class="s1"> organismsRef.current.</span><span class="s7">filter</span><span class="s1">(o </span><span class="s7">=&gt;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>o.alive </span><span class="s7">&amp;&amp;</span><span class="s1"> o.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">FOX</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">distance</span><span class="s1">(org.x, org.y, o.x, o.y) </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">5</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>).length;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">if</span><span class="s1"> (nearbyRabbits </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s3">3</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> nearbyFoxes </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">4</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s6">const</span><span class="s1"> angle </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">random</span><span class="s1">() </span><span class="s7">*</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s3">PI</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">2</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>toAdd.</span><span class="s7">push</span><span class="s1">({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">id</span><span class="s7">:</span><span class="s1"> </span><span class="s7">generateId</span><span class="s1">(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">type</span><span class="s7">:</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">FOX</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">x</span><span class="s7">:</span><span class="s1"> org.x </span><span class="s7">+</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">cos</span><span class="s1">(angle) </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.5</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">y</span><span class="s7">:</span><span class="s1"> org.y </span><span class="s7">+</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">sin</span><span class="s1">(angle) </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.5</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">alive</span><span class="s7">:</span><span class="s1"> </span><span class="s3">true</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">hungerTimer</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">reproductionTimer</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">health</span><span class="s7">:</span><span class="s1"> </span><span class="s3">100</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s2">trail</span><span class="s7">:</span><span class="s1"> []</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>org.reproductionTimer </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s1">// Grass spreading</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s3">Math</span><span class="s1">.</span><span class="s7">floor</span><span class="s1">(gameTimeRef.current) </span><span class="s7">%</span><span class="s1"> </span><span class="s3">5</span><span class="s1"> </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">floor</span><span class="s1">(gameTimeRef.current) </span><span class="s7">!==</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">floor</span><span class="s1">(gameTimeRef.current </span><span class="s7">-</span><span class="s1"> deltaTime)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> grassOrganisms </span><span class="s7">=</span><span class="s1"> newOrganisms.</span><span class="s7">filter</span><span class="s1">(o </span><span class="s7">=&gt;</span><span class="s1"> o.alive </span><span class="s7">&amp;&amp;</span><span class="s1"> o.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">GRASS</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> totalGrass </span><span class="s7">=</span><span class="s1"> grassOrganisms.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> maxGrass </span><span class="s7">=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.7</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (totalGrass </span><span class="s7">&lt;</span><span class="s1"> maxGrass) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>grassOrganisms.</span><span class="s7">forEach</span><span class="s1">(grass </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s3">Math</span><span class="s1">.</span><span class="s7">random</span><span class="s1">() </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">0.3</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s6">const</span><span class="s1"> directions </span><span class="s7">=</span><span class="s1"> [[</span><span class="s7">-</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">],[</span><span class="s3">1</span><span class="s1">,</span><span class="s3">0</span><span class="s1">],[</span><span class="s3">0</span><span class="s1">,</span><span class="s7">-</span><span class="s3">1</span><span class="s1">],[</span><span class="s3">0</span><span class="s1">,</span><span class="s3">1</span><span class="s1">]];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s6">const</span><span class="s1"> dir </span><span class="s7">=</span><span class="s1"> directions[</span><span class="s3">Math</span><span class="s1">.</span><span class="s7">floor</span><span class="s1">(</span><span class="s3">Math</span><span class="s1">.</span><span class="s7">random</span><span class="s1">() </span><span class="s7">*</span><span class="s1"> directions.length)];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s6">const</span><span class="s1"> newX </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">round</span><span class="s1">(grass.x) </span><span class="s7">+</span><span class="s1"> dir[</span><span class="s3">0</span><span class="s1">];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s6">const</span><span class="s1"> newY </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">round</span><span class="s1">(grass.y) </span><span class="s7">+</span><span class="s1"> dir[</span><span class="s3">1</span><span class="s1">];</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s6">if</span><span class="s1"> (newX </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> newX </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> newY </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> newY </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">const</span><span class="s1"> occupied </span><span class="s7">=</span><span class="s1"> newOrganisms.</span><span class="s7">some</span><span class="s1">(o </span><span class="s7">=&gt;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>o.alive </span><span class="s7">&amp;&amp;</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">round</span><span class="s1">(o.x) </span><span class="s7">===</span><span class="s1"> newX </span><span class="s7">&amp;&amp;</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">round</span><span class="s1">(o.y) </span><span class="s7">===</span><span class="s1"> newY</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">occupied) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>toAdd.</span><span class="s7">push</span><span class="s1">({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s2">id</span><span class="s7">:</span><span class="s1"> </span><span class="s7">generateId</span><span class="s1">(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s2">type</span><span class="s7">:</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">GRASS</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s2">x</span><span class="s7">:</span><span class="s1"> newX,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s2">y</span><span class="s7">:</span><span class="s1"> newY,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s2">alive</span><span class="s7">:</span><span class="s1"> </span><span class="s3">true</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s2">hungerTimer</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s2">reproductionTimer</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s2">health</span><span class="s7">:</span><span class="s1"> </span><span class="s3">100</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s2">trail</span><span class="s7">:</span><span class="s1"> []</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> filtered </span><span class="s7">=</span><span class="s1"> newOrganisms.</span><span class="s7">filter</span><span class="s1">(o </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">!</span><span class="s1">toRemove.</span><span class="s7">includes</span><span class="s1">(o.id));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> updated </span><span class="s7">=</span><span class="s1"> [</span><span class="s7">...</span><span class="s1">filtered, </span><span class="s7">...</span><span class="s1">toAdd];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organismsRef.current </span><span class="s7">=</span><span class="s1"> updated;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">setOrganisms</span><span class="s1">(updated);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s1">// Update population history</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s3">Math</span><span class="s1">.</span><span class="s7">floor</span><span class="s1">(gameTimeRef.current) </span><span class="s7">%</span><span class="s1"> </span><span class="s3">1</span><span class="s1"> </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> newCounts </span><span class="s7">=</span><span class="s1"> { </span><span class="s2">grass</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">, </span><span class="s2">rabbit</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">, </span><span class="s2">fox</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>updated.</span><span class="s7">forEach</span><span class="s1">(org </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">if</span><span class="s1"> (org.alive) newCounts[org.type]</span><span class="s7">++</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">setPopulationHistory</span><span class="s1">(prev </span><span class="s7">=&gt;</span><span class="s1"> [</span><span class="s7">...</span><span class="s1">prev, { </span><span class="s2">time</span><span class="s7">:</span><span class="s1"> gameTimeRef.current, </span><span class="s7">...</span><span class="s1">newCounts }].</span><span class="s7">slice</span><span class="s1">(</span><span class="s7">-</span><span class="s3">60</span><span class="s1">));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s1">// Check win/loss</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> newCounts </span><span class="s7">=</span><span class="s1"> { </span><span class="s2">grass</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">, </span><span class="s2">rabbit</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1">, </span><span class="s2">fox</span><span class="s7">:</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>updated.</span><span class="s7">forEach</span><span class="s1">(org </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (org.alive) newCounts[org.type]</span><span class="s7">++</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (newCounts.rabbit </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> newCounts.fox </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> newCounts.grass </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">setGameStatus</span><span class="s1">(</span><span class="s4">'lost'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">setIsPaused</span><span class="s1">(</span><span class="s3">true</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">deathCause) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">if</span><span class="s1"> (newCounts.grass </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1">) </span><span class="s7">setDeathCause</span><span class="s1">(</span><span class="s4">'Grass went extinct - overgrazed by rabbits'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">else</span><span class="s1"> </span><span class="s6">if</span><span class="s1"> (newCounts.rabbit </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1">) </span><span class="s7">setDeathCause</span><span class="s1">(</span><span class="s4">'Rabbits went extinct'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">else</span><span class="s1"> </span><span class="s6">if</span><span class="s1"> (newCounts.fox </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1">) </span><span class="s7">setDeathCause</span><span class="s1">(</span><span class="s4">'Foxes went extinct'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s6">else</span><span class="s1"> </span><span class="s6">if</span><span class="s1"> (gameTimeRef.current </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s3">WIN_DAYS</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">GAME_DAY_DURATION</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">setGameStatus</span><span class="s1">(</span><span class="s4">'won'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">setIsPaused</span><span class="s1">(</span><span class="s3">true</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">useEffect</span><span class="s1">(() </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (phase </span><span class="s7">!==</span><span class="s1"> </span><span class="s4">'playing'</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> isPaused) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">gameLoop</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> now </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Date</span><span class="s1">.</span><span class="s7">now</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> realDelta </span><span class="s7">=</span><span class="s1"> (now </span><span class="s7">-</span><span class="s1"> lastUpdateRef.current) </span><span class="s7">/</span><span class="s1"> </span><span class="s3">1000</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> gameDelta </span><span class="s7">=</span><span class="s1"> realDelta </span><span class="s7">*</span><span class="s1"> speed;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>lastUpdateRef.current </span><span class="s7">=</span><span class="s1"> now;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>gameTimeRef.current </span><span class="s7">+=</span><span class="s1"> gameDelta;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">setGameTime</span><span class="s1">(gameTimeRef.current);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">updateSimulation</span><span class="s1">(gameDelta);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>animationRef.current </span><span class="s7">=</span><span class="s1"> </span><span class="s7">requestAnimationFrame</span><span class="s1">(gameLoop);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>animationRef.current </span><span class="s7">=</span><span class="s1"> </span><span class="s7">requestAnimationFrame</span><span class="s1">(gameLoop);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">return</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (animationRef.current) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">cancelAnimationFrame</span><span class="s1">(animationRef.current);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, [phase, isPaused, speed]);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1">// Render canvas</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">useEffect</span><span class="s1">(() </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> canvas </span><span class="s7">=</span><span class="s1"> canvasRef.current;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">canvas) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> ctx </span><span class="s7">=</span><span class="s1"> canvas.</span><span class="s7">getContext</span><span class="s1">(</span><span class="s4">'2d'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> width </span><span class="s7">=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> height </span><span class="s7">=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ctx.</span><span class="s7">clearRect</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, width, height);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s1">// Background gradient</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> gradient </span><span class="s7">=</span><span class="s1"> ctx.</span><span class="s7">createLinearGradient</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, height);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>gradient.</span><span class="s7">addColorStop</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, </span><span class="s4">'#87CEEB'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>gradient.</span><span class="s7">addColorStop</span><span class="s1">(</span><span class="s3">0.5</span><span class="s1">, </span><span class="s4">'#90EE90'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>gradient.</span><span class="s7">addColorStop</span><span class="s1">(</span><span class="s3">1</span><span class="s1">, </span><span class="s4">'#8B7355'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ctx.fillStyle </span><span class="s7">=</span><span class="s1"> gradient;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ctx.</span><span class="s7">fillRect</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, width, height);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">// Grid lines</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ctx.strokeStyle </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'rgba(255, 255, 255, 0.2)'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ctx.lineWidth </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0.5</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">for</span><span class="s1"> (</span><span class="s6">let</span><span class="s1"> i </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">; i </span><span class="s7">&lt;=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1">; i</span><span class="s7">++</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">beginPath</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">moveTo</span><span class="s1">(i </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">, </span><span class="s3">0</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">lineTo</span><span class="s1">(i </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">, height);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">stroke</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">beginPath</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">moveTo</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, i </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">lineTo</span><span class="s1">(width, i </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">stroke</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s1">// Trial mode zones</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (trialMode </span><span class="s7">&amp;&amp;</span><span class="s1"> phase </span><span class="s7">===</span><span class="s1"> </span><span class="s4">'setup'</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.strokeStyle </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'rgba(34, 197, 94, 0.6)'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.fillStyle </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'rgba(34, 197, 94, 0.1)'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.lineWidth </span><span class="s7">=</span><span class="s1"> </span><span class="s3">2</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">setLineDash</span><span class="s1">([</span><span class="s3">5</span><span class="s1">, </span><span class="s3">5</span><span class="s1">]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> safeSize </span><span class="s7">=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.5</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> safeStart </span><span class="s7">=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.25</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">fillRect</span><span class="s1">(safeStart, safeStart, safeSize, safeSize);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">strokeRect</span><span class="s1">(safeStart, safeStart, safeSize, safeSize);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.strokeStyle </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'rgba(239, 68, 68, 0.6)'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.fillStyle </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'rgba(239, 68, 68, 0.1)'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> riskSize </span><span class="s7">=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.25</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">fillRect</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, riskSize, riskSize);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">strokeRect</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">, riskSize, riskSize);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">fillRect</span><span class="s1">(width </span><span class="s7">-</span><span class="s1"> riskSize, </span><span class="s3">0</span><span class="s1">, riskSize, riskSize);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">strokeRect</span><span class="s1">(width </span><span class="s7">-</span><span class="s1"> riskSize, </span><span class="s3">0</span><span class="s1">, riskSize, riskSize);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">fillRect</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, height </span><span class="s7">-</span><span class="s1"> riskSize, riskSize, riskSize);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">strokeRect</span><span class="s1">(</span><span class="s3">0</span><span class="s1">, height </span><span class="s7">-</span><span class="s1"> riskSize, riskSize, riskSize);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">fillRect</span><span class="s1">(width </span><span class="s7">-</span><span class="s1"> riskSize, height </span><span class="s7">-</span><span class="s1"> riskSize, riskSize, riskSize);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">strokeRect</span><span class="s1">(width </span><span class="s7">-</span><span class="s1"> riskSize, height </span><span class="s7">-</span><span class="s1"> riskSize, riskSize, riskSize);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">setLineDash</span><span class="s1">([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">// Heat map</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (showHeatMap </span><span class="s7">&amp;&amp;</span><span class="s1"> phase </span><span class="s7">===</span><span class="s1"> </span><span class="s4">'playing'</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> regionSize </span><span class="s7">=</span><span class="s1"> </span><span class="s3">4</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> regions </span><span class="s7">=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">/</span><span class="s1"> regionSize;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">for</span><span class="s1"> (</span><span class="s6">let</span><span class="s1"> ry </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">; ry </span><span class="s7">&lt;</span><span class="s1"> regions; ry</span><span class="s7">++</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">for</span><span class="s1"> (</span><span class="s6">let</span><span class="s1"> rx </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">; rx </span><span class="s7">&lt;</span><span class="s1"> regions; rx</span><span class="s7">++</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">const</span><span class="s1"> x1 </span><span class="s7">=</span><span class="s1"> rx </span><span class="s7">*</span><span class="s1"> regionSize;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">const</span><span class="s1"> y1 </span><span class="s7">=</span><span class="s1"> ry </span><span class="s7">*</span><span class="s1"> regionSize;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">const</span><span class="s1"> x2 </span><span class="s7">=</span><span class="s1"> x1 </span><span class="s7">+</span><span class="s1"> regionSize;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">const</span><span class="s1"> y2 </span><span class="s7">=</span><span class="s1"> y1 </span><span class="s7">+</span><span class="s1"> regionSize;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">let</span><span class="s1"> grass </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">, rabbit </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">, fox </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>organisms.</span><span class="s7">forEach</span><span class="s1">(org </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">org.alive) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s6">if</span><span class="s1"> (org.x </span><span class="s7">&gt;=</span><span class="s1"> x1 </span><span class="s7">&amp;&amp;</span><span class="s1"> org.x </span><span class="s7">&lt;</span><span class="s1"> x2 </span><span class="s7">&amp;&amp;</span><span class="s1"> org.y </span><span class="s7">&gt;=</span><span class="s1"> y1 </span><span class="s7">&amp;&amp;</span><span class="s1"> org.y </span><span class="s7">&lt;</span><span class="s1"> y2) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">if</span><span class="s1"> (org.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">GRASS</span><span class="s1">) grass</span><span class="s7">++</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">else</span><span class="s1"> </span><span class="s6">if</span><span class="s1"> (org.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">RABBIT</span><span class="s1">) rabbit</span><span class="s7">++</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">else</span><span class="s1"> </span><span class="s6">if</span><span class="s1"> (org.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">FOX</span><span class="s1">) fox</span><span class="s7">++</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">let</span><span class="s1"> color;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s6">if</span><span class="s1"> (grass </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> rabbit </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> fox </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">0</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>color </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'rgba(34, 197, 94, 0.3)'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>} </span><span class="s6">else</span><span class="s1"> </span><span class="s6">if</span><span class="s1"> (rabbit </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">10</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> fox </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">5</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>color </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'rgba(239, 68, 68, 0.3)'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>} </span><span class="s6">else</span><span class="s1"> </span><span class="s6">if</span><span class="s1"> (grass </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> rabbit </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>color </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'rgba(239, 68, 68, 0.3)'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>} </span><span class="s6">else</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>color </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'rgba(251, 191, 36, 0.3)'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>ctx.fillStyle </span><span class="s7">=</span><span class="s1"> color;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>ctx.</span><span class="s7">fillRect</span><span class="s1">(x1 </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">, y1 </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">, regionSize </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">, regionSize </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s1">// Movement trails</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> now </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Date</span><span class="s1">.</span><span class="s7">now</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organisms.</span><span class="s7">forEach</span><span class="s1">(org </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">org.alive </span><span class="s7">||</span><span class="s1"> org.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">GRASS</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">org.trail) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> colors </span><span class="s7">=</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s2">rabbit</span><span class="s7">:</span><span class="s1"> </span><span class="s4">'rgba(251, 146, 60, 0.3)'</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s2">fox</span><span class="s7">:</span><span class="s1"> </span><span class="s4">'rgba(239, 68, 68, 0.3)'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.strokeStyle </span><span class="s7">=</span><span class="s1"> colors[org.type];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.lineWidth </span><span class="s7">=</span><span class="s1"> </span><span class="s3">2</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">beginPath</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>org.trail.</span><span class="s7">forEach</span><span class="s1">((point, i) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">if</span><span class="s1"> (now </span><span class="s7">-</span><span class="s1"> point.time </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">2000</span><span class="s1">) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">const</span><span class="s1"> pos </span><span class="s7">=</span><span class="s1"> </span><span class="s7">gridToCanvas</span><span class="s1">(point.x, point.y);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">if</span><span class="s1"> (i </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1">) ctx.</span><span class="s7">moveTo</span><span class="s1">(pos.x, pos.y);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s6">else</span><span class="s1"> ctx.</span><span class="s7">lineTo</span><span class="s1">(pos.x, pos.y);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">stroke</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s1">// Draw organisms</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>organisms.</span><span class="s7">forEach</span><span class="s1">(org </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">org.alive) </span><span class="s6">return</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> pos </span><span class="s7">=</span><span class="s1"> </span><span class="s7">gridToCanvas</span><span class="s1">(org.x, org.y);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> sizes </span><span class="s7">=</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s2">grass</span><span class="s7">:</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.1</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s2">rabbit</span><span class="s7">:</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.25</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s2">fox</span><span class="s7">:</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">0.5</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> isHungry </span><span class="s7">=</span><span class="s1"> org.type </span><span class="s7">===</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">RABBIT</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> org.hungerTimer </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">6</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> org.hungerTimer </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s3">10</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> colors </span><span class="s7">=</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s2">grass</span><span class="s7">:</span><span class="s1"> </span><span class="s4">'#22c55e'</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s2">rabbit</span><span class="s7">:</span><span class="s1"> isHungry </span><span class="s7">?</span><span class="s1"> </span><span class="s4">'#fed7aa'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s4">'#fb923c'</span><span class="s1">,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s2">fox</span><span class="s7">:</span><span class="s1"> isHungry </span><span class="s7">?</span><span class="s1"> </span><span class="s4">'#fca5a5'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s4">'#ef4444'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> opacity </span><span class="s7">=</span><span class="s1"> isHungry </span><span class="s7">&amp;&amp;</span><span class="s1"> org.type </span><span class="s7">!==</span><span class="s1"> </span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">GRASS</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s3">0.6</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s3">1.0</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.globalAlpha </span><span class="s7">=</span><span class="s1"> opacity;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.fillStyle </span><span class="s7">=</span><span class="s1"> colors[org.type];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">beginPath</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">arc</span><span class="s1">(pos.x, pos.y, sizes[org.type], </span><span class="s3">0</span><span class="s1">, </span><span class="s3">Math</span><span class="s1">.</span><span class="s3">PI</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">2</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">fill</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.strokeStyle </span><span class="s7">=</span><span class="s1"> org.type </span><span class="s7">===</span><span class="s1"> </span><span class="s4">'grass'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s4">'#15803d'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                      </span>org.type </span><span class="s7">===</span><span class="s1"> </span><span class="s4">'rabbit'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> (isHungry </span><span class="s7">?</span><span class="s1"> </span><span class="s4">'#fdba74'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s4">'#ea580c'</span><span class="s1">) </span><span class="s7">:</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                      </span>(isHungry </span><span class="s7">?</span><span class="s1"> </span><span class="s4">'#fca5a5'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s4">'#991b1b'</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.lineWidth </span><span class="s7">=</span><span class="s1"> </span><span class="s3">1</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.</span><span class="s7">stroke</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>ctx.globalAlpha </span><span class="s7">=</span><span class="s1"> </span><span class="s3">1.0</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, [organisms, trialMode, showHeatMap, phase]);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">formatTime</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> (seconds) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> days </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">floor</span><span class="s1">(seconds </span><span class="s7">/</span><span class="s1"> </span><span class="s3">GAME_DAY_DURATION</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> remainingSeconds </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">floor</span><span class="s1">(seconds </span><span class="s7">%</span><span class="s1"> </span><span class="s3">GAME_DAY_DURATION</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">return</span><span class="s1"> `</span><span class="s4">Day </span><span class="s1">${days}</span><span class="s4"> (</span><span class="s1">${remainingSeconds}</span><span class="s4">s)</span><span class="s1">`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> </span><span class="s7">PopulationGraph</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> () </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (</span><span class="s7">!</span><span class="s1">showGraphs </span><span class="s7">||</span><span class="s1"> populationHistory.length </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s3">2</span><span class="s1">) </span><span class="s6">return</span><span class="s1"> </span><span class="s6">null</span><span class="s1">;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> graphHeight </span><span class="s7">=</span><span class="s1"> </span><span class="s3">120</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> graphWidth </span><span class="s7">=</span><span class="s1"> </span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> maxPop </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">max</span><span class="s1">(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">...</span><span class="s1">populationHistory.</span><span class="s7">map</span><span class="s1">(h </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s3">Math</span><span class="s1">.</span><span class="s7">max</span><span class="s1">(h.grass, h.rabbit </span><span class="s7">*</span><span class="s1"> </span><span class="s3">3</span><span class="s1">, h.fox </span><span class="s7">*</span><span class="s1"> </span><span class="s3">10</span><span class="s1">))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>);</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">return</span><span class="s1"> (</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                    </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s1">"absolute bottom-0 left-0 right-0 bg-black bg-opacity-60 p-2"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;</span><span class="s1">svg width</span><span class="s7">=</span><span class="s1">{graphWidth} height</span><span class="s7">=</span><span class="s1">{graphHeight} className</span><span class="s7">=</span><span class="s4">"w-full"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">defs</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">linearGradient id</span><span class="s7">=</span><span class="s4">"grassGradient"</span><span class="s1"> x1</span><span class="s7">=</span><span class="s4">"0%"</span><span class="s1"> y1</span><span class="s7">=</span><span class="s4">"0%"</span><span class="s1"> x2</span><span class="s7">=</span><span class="s4">"0%"</span><span class="s1"> y2</span><span class="s7">=</span><span class="s4">"100%"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">stop offset</span><span class="s7">=</span><span class="s4">"0%"</span><span class="s1"> stopColor</span><span class="s7">=</span><span class="s4">"#22c55e"</span><span class="s1"> stopOpacity</span><span class="s7">=</span><span class="s4">"0.6"</span><span class="s1"> </span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">stop offset</span><span class="s7">=</span><span class="s4">"100%"</span><span class="s1"> stopColor</span><span class="s7">=</span><span class="s4">"#22c55e"</span><span class="s1"> stopOpacity</span><span class="s7">=</span><span class="s4">"0.1"</span><span class="s1"> </span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">linearGradient</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;/</span><span class="s1">defs</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">path</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>d</span><span class="s7">=</span><span class="s1">{populationHistory.</span><span class="s7">map</span><span class="s1">((h, i) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">const</span><span class="s1"> x </span><span class="s7">=</span><span class="s1"> (i </span><span class="s7">/</span><span class="s1"> (populationHistory.length </span><span class="s7">-</span><span class="s1"> </span><span class="s3">1</span><span class="s1">)) </span><span class="s7">*</span><span class="s1"> graphWidth;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">const</span><span class="s1"> y </span><span class="s7">=</span><span class="s1"> graphHeight </span><span class="s7">-</span><span class="s1"> (h.grass </span><span class="s7">/</span><span class="s1"> maxPop) </span><span class="s7">*</span><span class="s1"> graphHeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">return</span><span class="s1"> `${i === 0 ? 'M' : 'L'}</span><span class="s4"> </span><span class="s1">${x}</span><span class="s4"> </span><span class="s1">${y}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}).</span><span class="s7">join</span><span class="s1">(</span><span class="s4">' '</span><span class="s1">) </span><span class="s7">+</span><span class="s1"> `</span><span class="s4"> L </span><span class="s1">${graphWidth}</span><span class="s4"> </span><span class="s1">${graphHeight}</span><span class="s4"> L 0 </span><span class="s1">${graphHeight}</span><span class="s4"> Z</span><span class="s1">`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>fill</span><span class="s7">=</span><span class="s4">"url(#grassGradient)"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>stroke</span><span class="s7">=</span><span class="s4">"#22c55e"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>strokeWidth</span><span class="s7">=</span><span class="s4">"2"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">path</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>d</span><span class="s7">=</span><span class="s1">{populationHistory.</span><span class="s7">map</span><span class="s1">((h, i) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">const</span><span class="s1"> x </span><span class="s7">=</span><span class="s1"> (i </span><span class="s7">/</span><span class="s1"> (populationHistory.length </span><span class="s7">-</span><span class="s1"> </span><span class="s3">1</span><span class="s1">)) </span><span class="s7">*</span><span class="s1"> graphWidth;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">const</span><span class="s1"> y </span><span class="s7">=</span><span class="s1"> graphHeight </span><span class="s7">-</span><span class="s1"> ((h.rabbit </span><span class="s7">*</span><span class="s1"> </span><span class="s3">3</span><span class="s1">) </span><span class="s7">/</span><span class="s1"> maxPop) </span><span class="s7">*</span><span class="s1"> graphHeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">return</span><span class="s1"> `${i === 0 ? 'M' : 'L'}</span><span class="s4"> </span><span class="s1">${x}</span><span class="s4"> </span><span class="s1">${y}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}).</span><span class="s7">join</span><span class="s1">(</span><span class="s4">' '</span><span class="s1">)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>fill</span><span class="s7">=</span><span class="s4">"none"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>stroke</span><span class="s7">=</span><span class="s4">"#fb923c"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>strokeWidth</span><span class="s7">=</span><span class="s4">"2"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">path</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>d</span><span class="s7">=</span><span class="s1">{populationHistory.</span><span class="s7">map</span><span class="s1">((h, i) </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">const</span><span class="s1"> x </span><span class="s7">=</span><span class="s1"> (i </span><span class="s7">/</span><span class="s1"> (populationHistory.length </span><span class="s7">-</span><span class="s1"> </span><span class="s3">1</span><span class="s1">)) </span><span class="s7">*</span><span class="s1"> graphWidth;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">const</span><span class="s1"> y </span><span class="s7">=</span><span class="s1"> graphHeight </span><span class="s7">-</span><span class="s1"> ((h.fox </span><span class="s7">*</span><span class="s1"> </span><span class="s3">10</span><span class="s1">) </span><span class="s7">/</span><span class="s1"> maxPop) </span><span class="s7">*</span><span class="s1"> graphHeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s6">return</span><span class="s1"> `${i === 0 ? 'M' : 'L'}</span><span class="s4"> </span><span class="s1">${x}</span><span class="s4"> </span><span class="s1">${y}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}).</span><span class="s7">join</span><span class="s1">(</span><span class="s4">' '</span><span class="s1">)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>fill</span><span class="s7">=</span><span class="s4">"none"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>stroke</span><span class="s7">=</span><span class="s4">"#ef4444"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>strokeWidth</span><span class="s7">=</span><span class="s4">"2"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;/</span><span class="s1">svg</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">return</span><span class="s1"> (</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s1">"flex flex-col h-screen bg-slate-900 text-white"</span><span class="s7">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                    </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s1">"h-16 bg-gradient-to-r from-slate-700 to-slate-800 flex items-center justify-between px-4 shadow-lg"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex gap-2"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onClick</span><span class="s7">=</span><span class="s1">{() </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setShowTutorial</span><span class="s1">(</span><span class="s3">true</span><span class="s1">)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>className</span><span class="s7">=</span><span class="s4">"p-2 hover:bg-slate-600 rounded"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">Info </span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"text-xl font-bold"</span><span class="s7">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                            </span>{phase </span><span class="s7">===</span><span class="s5"> </span><span class="s1">'setup'</span><span class="s5"> </span><span class="s7">?</span><span class="s5"> </span><span class="s1">'Setup Phase'</span><span class="s5"> </span><span class="s7">:</span><span class="s5"> </span><span class="s1">'Ecosystem Simulation'</span><span class="s5">}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex gap-2"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>{phase </span><span class="s7">===</span><span class="s1"> </span><span class="s4">'playing'</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>onClick</span><span class="s7">=</span><span class="s1">{() </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setShowGraphs</span><span class="s1">(</span><span class="s7">!</span><span class="s1">showGraphs)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>className</span><span class="s7">=</span><span class="s1">{`</span><span class="s4">p-2 rounded </span><span class="s1">${showGraphs ? 'bg-blue-600' : 'hover:bg-slate-600'}`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">BarChart3 </span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>onClick</span><span class="s7">=</span><span class="s1">{() </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setShowHeatMap</span><span class="s1">(</span><span class="s7">!</span><span class="s1">showHeatMap)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>className</span><span class="s7">=</span><span class="s1">{`</span><span class="s4">p-2 rounded </span><span class="s1">${showHeatMap ? 'bg-blue-600' : 'hover:bg-slate-600'}`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">MapPin </span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                    </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s1">"flex-1 flex items-center justify-center bg-slate-800 p-4 relative"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"relative"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">canvas</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>ref</span><span class="s7">=</span><span class="s1">{canvasRef}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>width</span><span class="s7">=</span><span class="s1">{</span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>height</span><span class="s7">=</span><span class="s1">{</span><span class="s3">GRID_SIZE</span><span class="s1"> </span><span class="s7">*</span><span class="s1"> </span><span class="s3">TILE_SIZE</span><span class="s1">}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onMouseDown</span><span class="s7">=</span><span class="s1">{handleMouseDown}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onMouseMove</span><span class="s7">=</span><span class="s1">{handleMouseMove}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onMouseUp</span><span class="s7">=</span><span class="s1">{handleMouseUp}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onMouseLeave</span><span class="s7">=</span><span class="s1">{handleMouseUp}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onTouchStart</span><span class="s7">=</span><span class="s1">{handleMouseDown}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onTouchMove</span><span class="s7">=</span><span class="s1">{handleMouseMove}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>onTouchEnd</span><span class="s7">=</span><span class="s1">{handleMouseUp}</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                </span>className</span><span class="s7">=</span><span class="s1">"border-2 border-slate-600 cursor-crosshair"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">PopulationGraph </span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                    </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s1">"h-16 bg-slate-950 flex items-center justify-around px-4"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"text-green-400 font-semibold"</span><span class="s7">&gt;</span><span class="s1">🌱 {counts.grass}</span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"text-orange-400 font-semibold"</span><span class="s7">&gt;</span><span class="s1">🐰 {counts.rabbit}</span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"text-red-400 font-semibold"</span><span class="s7">&gt;</span><span class="s1">🦊 {counts.fox}</span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>{phase </span><span class="s7">===</span><span class="s1"> </span><span class="s4">'playing'</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"text-blue-400 font-semibold"</span><span class="s7">&gt;</span><span class="s1">{</span><span class="s7">formatTime</span><span class="s1">(gameTime)}</span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"bg-slate-800 p-4"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>{phase </span><span class="s7">===</span><span class="s1"> </span><span class="s4">'setup'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"space-y-3"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex items-center justify-between mb-2"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">span className</span><span class="s7">=</span><span class="s4">"text-sm"</span><span class="s7">&gt;</span><span class="s1">Trial </span><span class="s7">Mode</span><span class="s1"> (Show Zones)</span><span class="s7">&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>onClick</span><span class="s7">=</span><span class="s1">{() </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setTrialMode</span><span class="s1">(</span><span class="s7">!</span><span class="s1">trialMode)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>className</span><span class="s7">=</span><span class="s1">{`</span><span class="s4">w-12 h-6 rounded-full transition-colors relative </span><span class="s1">${</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>trialMode ? 'bg-green-500' : 'bg-slate-600'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>}`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s5">{`</span><span class="s1">w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform </span><span class="s5">${</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>trialMode ? 'translate-x-6' : 'translate-x-1'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>}`} </span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex gap-2"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>onClick</span><span class="s7">=</span><span class="s1">{() </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setSelectedTool</span><span class="s1">(</span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">GRASS</span><span class="s1">)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>className</span><span class="s7">=</span><span class="s1">{`</span><span class="s4">flex-1 py-3 rounded font-semibold transition-colors </span><span class="s1">${</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>selectedTool === SPECIES.GRASS</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span>? 'bg-green-500 text-white'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span>: 'bg-slate-700 text-gray-300 hover:bg-slate-600'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>}`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>🌱 Grass</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>onClick</span><span class="s7">=</span><span class="s1">{() </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setSelectedTool</span><span class="s1">(</span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">RABBIT</span><span class="s1">)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>className</span><span class="s7">=</span><span class="s1">{`</span><span class="s4">flex-1 py-3 rounded font-semibold transition-colors </span><span class="s1">${</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>selectedTool === SPECIES.RABBIT</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span>? 'bg-orange-500 text-white'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span>: 'bg-slate-700 text-gray-300 hover:bg-slate-600'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>}`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>🐰 Rabbit</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>onClick</span><span class="s7">=</span><span class="s1">{() </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setSelectedTool</span><span class="s1">(</span><span class="s3">SPECIES</span><span class="s1">.</span><span class="s3">FOX</span><span class="s1">)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>className</span><span class="s7">=</span><span class="s1">{`</span><span class="s4">flex-1 py-3 rounded font-semibold transition-colors </span><span class="s1">${</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>selectedTool === SPECIES.FOX</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span>? 'bg-red-500 text-white'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span>: 'bg-slate-700 text-gray-300 hover:bg-slate-600'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>}`}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>🦊 Fox</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex gap-2"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>onClick</span><span class="s7">=</span><span class="s1">{startSimulation}</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                        </span>className</span><span class="s7">=</span><span class="s1">"flex-1 py-3 bg-blue-500 hover:bg-blue-600 rounded font-semibold transition-colors"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>Start Simulation</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>onClick</span><span class="s7">=</span><span class="s1">{clearField}</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                        </span>className</span><span class="s7">=</span><span class="s1">"px-6 py-3 bg-red-500 hover:bg-red-600 rounded font-semibold transition-colors"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>Clear</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>) </span><span class="s7">:</span><span class="s1"> (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"space-y-3"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex items-center gap-4"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>onClick</span><span class="s7">=</span><span class="s1">{() </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setIsPaused</span><span class="s1">(</span><span class="s7">!</span><span class="s1">isPaused)}</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                        </span>className</span><span class="s7">=</span><span class="s1">"p-3 bg-blue-500 hover:bg-blue-600 rounded transition-colors"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>{isPaused </span><span class="s7">?</span><span class="s1"> </span><span class="s7">&lt;</span><span class="s1">Play </span><span class="s7">/&gt;</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s7">&lt;</span><span class="s1">Pause </span><span class="s7">/&gt;</span><span class="s1">}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex-1"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex justify-between text-sm mb-1"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">span</span><span class="s7">&gt;</span><span class="s1">Speed</span><span class="s7">:</span><span class="s1"> {speed}x</span><span class="s7">&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">span className</span><span class="s7">=</span><span class="s4">"text-slate-400"</span><span class="s7">&gt;</span><span class="s3">0</span><span class="s1">.5x </span><span class="s7">-</span><span class="s1"> 4x</span><span class="s7">&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">input</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>type</span><span class="s7">=</span><span class="s4">"range"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>min</span><span class="s7">=</span><span class="s4">"0.5"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>max</span><span class="s7">=</span><span class="s4">"4"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>step</span><span class="s7">=</span><span class="s4">"0.5"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>value</span><span class="s7">=</span><span class="s1">{speed}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>onChange</span><span class="s7">=</span><span class="s1">{(e) </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setSpeed</span><span class="s1">(</span><span class="s7">parseFloat</span><span class="s1">(e.target.value))}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>className</span><span class="s7">=</span><span class="s4">"w-full"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>onClick</span><span class="s7">=</span><span class="s1">{resetGame}</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                        </span>className</span><span class="s7">=</span><span class="s1">"p-3 bg-red-500 hover:bg-red-600 rounded transition-colors"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">RotateCcw </span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>{showTutorial </span><span class="s7">&amp;&amp;</span><span class="s1"> (</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s1">"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 overflow-y-auto"</span><span class="s7">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s1">"bg-slate-800 p-6 rounded-lg max-w-2xl max-h-[90vh] overflow-y-auto"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex justify-between items-center mb-4"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">h2 className</span><span class="s7">=</span><span class="s4">"text-2xl font-bold"</span><span class="s7">&gt;</span><span class="s1">How to Play</span><span class="s7">&lt;/</span><span class="s1">h2</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">button onClick</span><span class="s7">=</span><span class="s1">{() </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setShowTutorial</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)} className</span><span class="s7">=</span><span class="s4">"p-2 hover:bg-slate-700 rounded"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s3">X</span><span class="s1"> </span><span class="s7">/&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"space-y-4 text-sm"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">h3 className</span><span class="s7">=</span><span class="s4">"text-lg font-bold text-green-400 mb-2"</span><span class="s7">&gt;</span><span class="s1">🎯 Goal</span><span class="s7">&lt;/</span><span class="s1">h3</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">p</span><span class="s7">&gt;</span><span class="s1">Create a balanced ecosystem that survives </span><span class="s6">for</span><span class="s1"> </span><span class="s3">10</span><span class="s1"> </span><span class="s7">days</span><span class="s1"> (</span><span class="s3">5</span><span class="s1"> minutes). All three species must stay alive</span><span class="s7">!&lt;/</span><span class="s1">p</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">h3 className</span><span class="s7">=</span><span class="s4">"text-lg font-bold text-blue-400 mb-2"</span><span class="s7">&gt;</span><span class="s1">🌱 Setup Phase</span><span class="s7">&lt;/</span><span class="s1">h3</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">ul className</span><span class="s7">=</span><span class="s4">"list-disc list-inside space-y-1"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Select Grass, Rabbit, or Fox</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Click</span><span class="s7">/</span><span class="s1">tap and hold to place organisms</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Use Trial Mode to see </span><span class="s7">safe</span><span class="s1"> (green) and </span><span class="s7">risky</span><span class="s1"> (red) zones</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Press Start when ready</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;/</span><span class="s1">ul</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">h3 className</span><span class="s7">=</span><span class="s4">"text-lg font-bold text-purple-400 mb-2"</span><span class="s7">&gt;</span><span class="s1">⚡ Species Mechanics</span><span class="s7">&lt;/</span><span class="s1">h3</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"space-y-2"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span></span><span class="s7">&lt;</span><span class="s1">strong className</span><span class="s7">=</span><span class="s4">"text-green-400"</span><span class="s7">&gt;</span><span class="s1">🌱 Grass</span><span class="s7">:&lt;/</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1"> Spreads every </span><span class="s3">5</span><span class="s1"> seconds. Eaten by rabbits.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span></span><span class="s7">&lt;</span><span class="s1">strong className</span><span class="s7">=</span><span class="s4">"text-orange-400"</span><span class="s7">&gt;</span><span class="s1">🐰 Rabbits</span><span class="s7">:&lt;/</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1"> Hunt grass within </span><span class="s3">3</span><span class="s1"> tiles. Starve </span><span class="s6">in</span><span class="s1"> 12s. Reproduce every 40s.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                                </span></span><span class="s7">&lt;</span><span class="s1">strong className</span><span class="s7">=</span><span class="s4">"text-red-400"</span><span class="s7">&gt;</span><span class="s1">🦊 Foxes</span><span class="s7">:&lt;/</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1"> Hunt rabbits within </span><span class="s3">5</span><span class="s1"> tiles. Starve </span><span class="s6">in</span><span class="s1"> 25s. Reproduce every 90s.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">h3 className</span><span class="s7">=</span><span class="s4">"text-lg font-bold text-yellow-400 mb-2"</span><span class="s7">&gt;</span><span class="s1">💡 Tips</span><span class="s7">&lt;/</span><span class="s1">h3</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">ul className</span><span class="s7">=</span><span class="s4">"list-disc list-inside space-y-1"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;&lt;</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1">Ratio</span><span class="s7">:&lt;/</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1"> Try </span><span class="s3">120</span><span class="s1"> </span><span class="s2">Grass</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s3">35</span><span class="s1"> </span><span class="s2">Rabbits</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s3">10</span><span class="s1"> Foxes</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;&lt;</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1">Spacing</span><span class="s7">:&lt;/</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1"> Don</span><span class="s4">'t place all in corners - they'</span><span class="s1">ll starve</span><span class="s7">!&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;&lt;</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1">Clusters</span><span class="s7">:&lt;/</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1"> Create </span><span class="s3">4</span><span class="s7">-</span><span class="s3">6</span><span class="s1"> grass clusters across the field</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;&lt;</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1">Balance</span><span class="s7">:&lt;/</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1"> Too many predators </span><span class="s7">=</span><span class="s1"> prey extinction</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;/</span><span class="s1">ul</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">h3 className</span><span class="s7">=</span><span class="s4">"text-lg font-bold text-red-400 mb-2"</span><span class="s7">&gt;</span><span class="s1">❌ Common Failures</span><span class="s7">&lt;/</span><span class="s1">h3</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">ul className</span><span class="s7">=</span><span class="s4">"list-disc list-inside space-y-1"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Too many foxes → Rabbits extinct</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Too few foxes → Rabbits overgraze → All grass gone</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Corner placement → Can't reach food </span><span class="s6">in</span><span class="s1"> time</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;/</span><span class="s1">ul</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">h3 className</span><span class="s7">=</span><span class="s4">"text-lg font-bold text-cyan-400 mb-2"</span><span class="s7">&gt;</span><span class="s1">🎮 During Simulation</span><span class="s7">&lt;/</span><span class="s1">h3</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">ul className</span><span class="s7">=</span><span class="s4">"list-disc list-inside space-y-1"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Use Pause</span><span class="s7">/</span><span class="s1">Play to observe</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Adjust </span><span class="s7">speed</span><span class="s1"> (</span><span class="s3">0</span><span class="s1">.5x to 4x)</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Toggle </span><span class="s7">graphs</span><span class="s1"> (📊) to see population trends</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">&lt;</span><span class="s1">li</span><span class="s7">&gt;</span><span class="s1">Toggle heat </span><span class="s7">map</span><span class="s1"> (📍) to see regional health</span><span class="s7">&lt;/</span><span class="s1">li</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;/</span><span class="s1">ul</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">section</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>onClick</span><span class="s7">=</span><span class="s1">{() </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">setShowTutorial</span><span class="s1">(</span><span class="s3">false</span><span class="s1">)}</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                    </span>className</span><span class="s7">=</span><span class="s1">"w-full mt-6 py-3 bg-blue-500 hover:bg-blue-600 rounded font-semibold"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>Got It</span><span class="s7">!</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>)}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>{gameStatus </span><span class="s7">&amp;&amp;</span><span class="s1"> (</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s1">"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"bg-slate-800 p-8 rounded-lg max-w-md"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">h2 className</span><span class="s7">=</span><span class="s1">{`</span><span class="s4">text-3xl font-bold mb-4 </span><span class="s1">${</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>gameStatus === 'won' ? 'text-green-400' : 'text-red-400'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>}`}</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>{gameStatus </span><span class="s7">===</span><span class="s1"> </span><span class="s4">'won'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s4">'🏆 Victory!'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s4">'💀 Ecosystem Collapsed'</span><span class="s1">}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">h2</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">p className</span><span class="s7">=</span><span class="s4">"text-lg mb-4"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>{gameStatus </span><span class="s7">===</span><span class="s1"> </span><span class="s4">'won'</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                        </span></span><span class="s7">?</span><span class="s5"> `</span><span class="s1">You successfully maintained a balanced ecosystem for </span><span class="s5">${WIN_DAYS}</span><span class="s1"> days!</span><span class="s5">`</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                        </span></span><span class="s7">:</span><span class="s5"> deathCause </span><span class="s7">||</span><span class="s5"> </span><span class="s1">'One or more species went extinct. The ecosystem could not sustain itself.'</span><span class="s5">}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">p</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"bg-slate-900 p-4 rounded mb-6 space-y-2"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"font-bold mb-2"</span><span class="s7">&gt;</span><span class="s1">Final Statistics</span><span class="s7">:&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex justify-between"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">span className</span><span class="s7">=</span><span class="s4">"text-green-400"</span><span class="s7">&gt;</span><span class="s1">🌱 Grass</span><span class="s7">:&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">span className</span><span class="s7">=</span><span class="s4">"font-bold"</span><span class="s7">&gt;</span><span class="s1">{counts.grass}</span><span class="s7">&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex justify-between"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">span className</span><span class="s7">=</span><span class="s4">"text-orange-400"</span><span class="s7">&gt;</span><span class="s1">🐰 Rabbits</span><span class="s7">:&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">span className</span><span class="s7">=</span><span class="s4">"font-bold"</span><span class="s7">&gt;</span><span class="s1">{counts.rabbit}</span><span class="s7">&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s1">div className</span><span class="s7">=</span><span class="s4">"flex justify-between"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">span className</span><span class="s7">=</span><span class="s4">"text-red-400"</span><span class="s7">&gt;</span><span class="s1">🦊 Foxes</span><span class="s7">:&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">span className</span><span class="s7">=</span><span class="s4">"font-bold"</span><span class="s7">&gt;</span><span class="s1">{counts.fox}</span><span class="s7">&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s1">"flex justify-between border-t border-slate-700 pt-2 mt-2"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">span className</span><span class="s7">=</span><span class="s4">"text-blue-400"</span><span class="s7">&gt;</span><span class="s1">Time Survived</span><span class="s7">:&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">span className</span><span class="s7">=</span><span class="s4">"font-bold"</span><span class="s7">&gt;</span><span class="s1">{</span><span class="s7">formatTime</span><span class="s1">(gameTime)}</span><span class="s7">&lt;/</span><span class="s1">span</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>{gameStatus </span><span class="s7">===</span><span class="s1"> </span><span class="s4">'lost'</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> (</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;</span><span class="s5">div className</span><span class="s7">=</span><span class="s1">"bg-red-900 bg-opacity-30 p-3 rounded mb-4 text-sm"</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span></span><span class="s7">&lt;</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1">💡 Tip</span><span class="s7">:&lt;/</span><span class="s1">strong</span><span class="s7">&gt;</span><span class="s1"> {</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                            </span>counts.fox </span><span class="s7">===</span><span class="s5"> </span><span class="s3">0</span><span class="s5"> </span><span class="s7">?</span><span class="s5"> </span><span class="s1">'Place foxes closer to rabbit populations or reduce rabbit numbers.'</span><span class="s5"> </span><span class="s7">:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span>counts.rabbit </span><span class="s7">===</span><span class="s1"> </span><span class="s3">0</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s4">'Reduce fox count or spread rabbits across more grass zones.'</span><span class="s1"> </span><span class="s7">:</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                            </span>counts.grass </span><span class="s7">===</span><span class="s5"> </span><span class="s3">0</span><span class="s5"> </span><span class="s7">?</span><span class="s5"> </span><span class="s1">'Start with more grass or fewer rabbits to prevent overgrazing.'</span><span class="s5"> </span><span class="s7">:</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s4">'Check your placement and ratios!'</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;</span><span class="s1">button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>onClick</span><span class="s7">=</span><span class="s1">{resetGame}</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">                                    </span>className</span><span class="s7">=</span><span class="s1">"w-full py-3 bg-blue-500 hover:bg-blue-600 rounded font-semibold transition-colors"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>Try Again</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">&lt;/</span><span class="s1">button</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>)}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">&lt;/</span><span class="s1">div</span><span class="s7">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ReactDOM.</span><span class="s7">render</span><span class="s1">(</span><span class="s7">&lt;</span><span class="s1">EcosystemGame </span><span class="s7">/&gt;</span><span class="s1">, </span><span class="s7">document</span><span class="s1">.</span><span class="s7">getElementById</span><span class="s1">(</span><span class="s4">'root'</span><span class="s1">));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/</span><span class="s2">script</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s5">&lt;/</span><span class="s1">body</span><span class="s5">&gt;</span></p>
<p class="p2"><span class="s5">&lt;/</span><span class="s1">html</span><span class="s5">&gt;</span></p>
</body>
</html>
